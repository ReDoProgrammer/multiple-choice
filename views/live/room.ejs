<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="modalRoom">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="row">
        <div class="col-md-10 col-sm-8 col-xs-12">
          <div class="panel-success">
            <div class="panel-heading">
              <button type="button" class="btn btn-sm btn-warning" id="btnStart">Bắt đầu</button>
              <input type="hidden" id="room_id" value="">
              <input type="hidden" id="subject_id" value="">
            </div>
            <!-- /.card-header -->
            <div class="panel-body" style="margin-top:10px;" id="questions">

            </div>
            <!-- /.card-body -->
          </div>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-12">
          <div class="panel-success">
            <div class="panel-heading">
              <h6 style = "color:#fff;">Hiện tại (<span id="current_candidates" class="text-danger">0</span>)</h6>
            </div>
            <!-- /.card-header -->
            <div class="panel-body" style="margin-top:10px;" id="candidates">
            </div>
            <!-- /.card-body -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<script type="text/javascript">

  $('#btnStart').click(function(){
    let subject_id = $('#subject_id').val();
    let room_id = $('#room_id').val();
    $.ajax({
      url:'/live/generate-exam',
      type:'post',
      data:{
        room:room_id,
        subject:subject_id
      },
      success:function(data){
        if(data.code == 200){
          let d = {
            questions:data.questions,
            room:room_id
          };
          socket.emit('send-exam',d);
        }
      }
    });
  });

  socket.on('populate-exam',(data)=>{
    let room_id = $('#room_id').val();
    if(data.room == room_id){
      let q = '';
      $.each(data.questions,function(k,v){
         q+=   '<div class="row">';
         q+=     '<h5 class = "text-danger">'+v.question+'</h5>';
         q+=     '<fieldset>';
         q+=       '<label class="A"><input type="radio" name="'+v._id+'" value="A. ">'+v.option_a+'</label>';
         q+=       '<label class="B"><input type="radio" name="'+v._id+'" value="B. ">'+v.option_b+'</label>';
         q+=       '<label class="C"><input type="radio" name="'+v._id+'" value="C. ">'+v.option_c+'</label>';
         q+=       '<label class="D"><input type="radio" name="'+v._id+'" value="D. ">'+v.option_d+'</label>';
         q+=     '</fieldset>';
         q+=   '</div>';
         q+=   '<hr>';
      });
      $('#questions').append(q);
    }
  });
</script>
